# Chat Agent Matrix - Docker Instance Configuration Template
# This file is automatically generated by setup_docker.sh based on instance parameters
# Should not be manually edited - to modify, please re-run setup_docker.sh

services:
  bot:
    build:
      context: ../
      dockerfile: docker-deploy/Dockerfile
      args:
        BUILD_USER: {USER}
    container_name: chat-agent-{INSTANCE_NAME}
    restart: unless-stopped
    user: "1000:1000"
    environment:
      - INSTANCE_NAME={INSTANCE_NAME}
    volumes:
      # Agent home directory (shared code across all instances)
      - ../agent_home:/app/telegram/agent_home
      # User home directory (authentication isolation)
      - ./container_home/{INSTANCE_NAME}:/home/{USER}
      # Instance configuration files
      - ./.env.{INSTANCE_NAME}:/app/telegram/.env
      - ./config.{INSTANCE_NAME}.yaml:/app/telegram/config.yaml
    dns:
      - 8.8.8.8
      - 8.8.4.4
    networks:
      - telegram_net_{INSTANCE_NAME}

networks:
  telegram_net_{INSTANCE_NAME}:
    driver: bridge
    name: telegram_net_{INSTANCE_NAME}
